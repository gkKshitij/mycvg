{% extends 'blogs/base.html' %}
{% load markdownify %}


{% block title %}{{post.title}}{% endblock %}
{% block content %}

    <div>
        {% if post.published_date %}
        <div>
            {{post.published_date}}
        </div>
        {% else %}
            <a href="{% url 'blogs:post_publish' pk=post.pk %}" class="btn btn-primary">Publish</a>
        {% endif %}

        {% if user.is_authenticated %}
        <a href="{% url 'blogs:post_edit' pk=post.pk %}"><i class="fa fa-edit fa-4x"></i></a>
        <a href="{% url 'blogs:delete_post' pk=post.pk %}" class="btn btn-danger" 
        onclick="return confirm('Are you sure?')"><i class="fa fa-trash-o fa-2x" aria-hidden="true"></i></a>
        {% endif %}

        <h1>{{post.title}}</h1>
        <p>{{ post.text | markdown | safe }}</p>
    </div>

    <hr> 

    <a href="{% url 'blogs:add_comment' pk=post.pk %}" class="btn btn-secondary">Add Comment</a>
    <br>

    {% for comment in post.comments.all %}
    {% if user.is_authenticated or comment.approved %}
        <div class="">

        {% if not comment.approved and user.is_superuser %}
        <a href="{% url 'blogs:approve_comment' pk=comment.pk %}" class="btn btn-primary"><i class="fa fa-check" aria-hidden="true"></i></a>
        <a href="{% url 'blogs:remove_comment' pk=comment.pk %}" class="btn"><i class="fa fa-trash" aria-hidden="true"></i></a>
        {% endif %}
            <strong>{{comment.author}}</strong>
            <p>{{comment.text | markdown | safe }}</p>
            {% endif %}
            {% empty %}

        </div>
    <p>No comments yet..</p>
    
    {% endfor %}
    
{% endblock %}